---
sidebar: sidebar 
permalink: task_config_telegraf_flink.html 
keywords: telegraf, installation, install, flink 
summary: Flink 数据收集器配置 
---
= Flink 数据收集器
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights 使用此数据收集器从 Flink 收集指标。



== 安装

. 从*Observability > Collectors*中，单击*+Data Collector*。选择"链接"。
+
选择安装了 Telegraf 代理的操作系统或平台。

. 如果您尚未安装要收集的代理，或者您希望为其他操作系统或平台安装代理，请单击 _Show Instructions_展开 link:task_config_telegraf_agent.html["代理安装"] 说明。
. 选择要用于此数据收集器的代理访问密钥。您可以通过单击 * + 代理访问密钥 * 按钮来添加新的代理访问密钥。最佳实践：仅当您要按操作系统 / 平台对数据收集器进行分组时，才使用其他代理访问密钥。
. 按照配置步骤配置数据收集器。这些说明因用于收集数据的操作系统或平台的类型而异。


image:FlinkDCConfigWindows.png["Flink 配置"]



== 设置

完整的 Flink 部署包括以下组件：

JobManager ： Flink 主系统。协调一系列 TaskManager 。在高可用性设置中，系统将具有多个 JobManager 。
TaskManager ：执行 Flink 运算符的位置。
Flink 插件基于此电报的 JOLokia 插件。例如，需要从所有 Flink 组件收集信息，因此需要在所有组件上通过 Jallokia 配置并公开 JMX 。



=== 兼容性

此配置是根据 Flink 1.0.0 版开发的。



=== 设置



==== JOLokia Agent Jar

对于所有单个组件，必须下载一个版本的 jarokia 代理 JAR 文件。测试的版本为 link:https://jolokia.org/download.html["JOLokia 代理 1.6.0"]。

以下说明假定已下载的 JAR 文件（ jolokia-jvm-1.6.0-agent.jar ）位于位置 "/opt/Flink/lib/" 下。



==== JobManager

要将 JobManager 配置为公开此 Jobokia API ，您可以在节点上设置以下环境变量，然后重新启动 JobManager ：

 export FLINK_ENV_JAVA_OPTS="-javaagent:/opt/flink/lib/jolokia-jvm-1.6.0-agent.jar=port=8778,host=0.0.0.0"
您可以为朱洛基亚选择其他端口（ 8778 ）。如果您有一个内部 IP 来锁定 Jallokia ，则可以将 "catch all" 0.0.0.0 替换为您自己的 IP 。请注意，此 IP 需要可从电报插件访问。



==== TaskManager

要配置 TaskManager 以公开此 JOLokia API ，您可以在节点上设置以下环境变量，然后重新启动 TaskManager ：

 export FLINK_ENV_JAVA_OPTS="-javaagent:/opt/flink/lib/jolokia-jvm-1.6.0-agent.jar=port=8778,host=0.0.0.0"
您可以为朱洛基亚选择其他端口（ 8778 ）。如果您有一个内部 IP 来锁定 Jallokia ，则可以将 "catch all" 0.0.0.0 替换为您自己的 IP 。请注意，此 IP 需要可从电报插件访问。



== 对象和计数器

将收集以下对象及其计数器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 对象： | 标识符： | 属性： | 数据点： 


| Flink 任务管理器 | 集群
命名空间
服务器 | 节点名称
任务管理器ID
节点IP | 网络可用内存段
网络总内存段数
垃圾收集PS标记清除计数
垃圾收集PS标记清除时间
垃圾收集PS Scavenge计数
垃圾收集PS收集时间
已提交堆内存
堆内存已启用
堆内存最大值
已用堆内存
线程计数守护进程
线程数峰值
线程数
已启动总线程数 


| Flink 作业 | 集群
命名空间
服务器
作业 ID | 节点名称
作业名称
节点IP
最后一个点外部路径
重新启动时间 | 停机
完全重新启动
上次对齐的校准已进行了调整
上次执行的"持续时间"
最后一个"项"大小
已完成检查点的数量
失败的检查点数量
进行中的检查点数量
检查点数量
正常运行时间 


| Flink 作业管理器 | 集群
命名空间
服务器 | 节点名称
节点IP | 垃圾收集PS标记清除计数
垃圾收集PS标记清除时间
垃圾收集PS Scavenge计数
垃圾收集PS收集时间
已提交堆内存
堆内存已启用
堆内存最大值
已用堆内存
注册的任务管理器数量
正在运行的作业数
任务插槽可用
任务插槽总数
线程计数守护进程
线程数峰值
线程数
已启动总线程数 


| Flink 任务 | 集群
命名空间
作业 ID
任务 ID | 服务器
节点名称
作业名称
子任务索引
任务尝试ID
任务尝试次数
任务名称
任务管理器ID
节点IP
电流输入水印 | 池使用情况中的缓冲区
队列长度中的缓冲区
缓冲池使用量
缓冲区出队列长度
本地中的缓冲区数量
每秒本地缓冲区数计数
每秒本地缓冲区数
远程中的缓冲区数量
每秒远程缓冲区数计数
每秒远程缓冲区数
缓冲区数量
每秒缓冲区数计数
每秒缓冲区数量
本地字节数
每秒本地字节数
以每秒本地速率表示的字节数
远程中的字节数
远程每秒字节数
远程/秒速率中的字节数
传出的字节数
每秒传出的字节数
每秒传出的字节数
中的记录数
每秒记录数
每秒记录数
将记录数移出
每秒输出的记录数计数
每秒输出的记录数 


| Flink 任务操作员 | 集群
命名空间
作业 ID
操作员ID
任务 ID | 服务器
节点名称
作业名称
操作员名称
子任务索引
任务尝试ID
任务尝试次数
任务名称
任务管理器ID
节点IP | 电流输入水印
电流输出水印
中的记录数
每秒记录数
每秒记录数
将记录数移出
每秒输出的记录数计数
每秒输出的记录数
已删除的延迟记录数
分配的分区
已用字节数速率
提交延迟平均值
提交延迟最大值
提交速率
提交失败
提交成功
连接关闭速率
连接计数
连接创建速率
计数
提取延迟平均值
提取延迟最大值
提取速率
提取大小平均值
提取大小最大值
提取限制时间平均值
提取限制时间最大值
检测信号速率
传入字节速率
IO比率
平均IO时间(ns)
IO等待比率
IO等待时间平均值(ns)
加入率
平均加入时间
上次检测信号前
网络IO速率
传出字节速率
记录消耗率
记录滞后最大值
每个请求平均记录数
请求率
平均请求大小
请求大小最大值
响应率
选择速率
同步速率
平均同步时间
检测信号响应时间最长
加入时间最大值
同步时间最大值 
|===


== 故障排除

可以从找到追加信息 link:concept_requesting_support.html["支持"] 页面。
