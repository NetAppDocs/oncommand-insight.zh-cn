---
sidebar: sidebar 
permalink: task_config_telegraf_kubernetes.html 
keywords: telegraf, installation, install, kubernetes 
summary: Kubernetes 数据收集器配置 
---
= Kubernetes Data Collector
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights 使用此数据收集器收集 Kubernetes Pod ，节点和容器指标。



== 安装

有关 Kubernetes 安装说明，请参见 link:task_config_telegraf_agent.html#kubernetes["代理安装"] 页面。


NOTE: 有关 * Kube-state-metrics* 的信息已移至 link:task_config_telegraf_agent.html#kubernetes["代理安装"] 页面。



== 对象和计数器

将收集以下对象及其计数器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 对象： | 标识符： | 属性： | 数据点： 


| Kubernetes 容器 | 命名空间
POD
容器
集群 | Kubernetes 节点
节点名称
节点操作系统
节点 UUID
节点IP | CPU纳秒
CPU使用量纳米级
内存主要页面错误
内存驻留集大小(RSS)
内存工作集
内存页故障
内存使用量
根文件系统可用
根文件系统容量
已使用根文件系统 


| Kubernetes 节点 | Kubernetes 节点
集群 | 节点名称
节点操作系统
节点 UUID
节点IP | CPU使用量纳米级
CPU使用量(纳秒)
文件系统可用
文件系统总数
已使用文件系统
内存可用
内存使用量
内存主要页面错误
内存页故障
内存驻留集大小(RSS)
内存工作集
网络RX错误(每秒)
网络RX字节(每秒)
网络TX错误(每秒)
网络TX字节(每秒)
运行时映像文件系统可用
已使用运行时映像文件系统
运行时映像文件系统容量 


| Kubernetes Pod | 命名空间
POD
集群 | Kubernetes 节点
节点名称
节点IP
节点操作系统
节点 UUID | 网络TX字节(每秒)
网络TX错误(每秒)
网络RX字节(每秒)
网络RX错误(每秒) 


| Kubernetes Pod 卷 | Volume
POD
集群
命名空间 | Kubernetes 节点
节点名称
节点 UUID
节点IP
节点操作系统 | 可用
Capacity
已用 


| Kubernetes 系统容器 | 系统容器
Kubernetes 节点
集群 | 节点名称
节点IP
节点操作系统
节点 UUID | CPU使用量纳米级
CPU使用量内核纳秒
内存主要页面错误
内存页故障
内存驻留集大小(RSS)
内存使用量
内存工作集
根文件系统可用
根文件系统容量
日志文件系统可用
记录文件系统容量 
|===


== 故障排除

[cols="2*"]
|===
| 问题： | 请尝试以下操作： 


| 我运行了Kubernetes代理安装程序命令、但未看到Telegraf代理Pod通过以下方式运行：

 sudo kubect--命名 空间CI-monitoring get Pod | 检查部署DemonSet时是否出现任何错误：

 sudo kubect--命名 空间cI-monitoring描述DS报机-ds

如果存在与SecurityContextConnors相关的错误、请执行以下操作：

1.生成电报DemonSet YAML

 sudo kubectl --命名 空间CI-monitoring get DS tgrataf-ds -o yaml >/tmp/tgrataf-ds.yaml

2.停止电报服务

 sudo kubect--命名 空间CI-monitoring delete DS s德 拉夫-ds

3.创建所需的SecurityContextConstraint (请参见"配置代理以收集数据"一节)

4.重新创建Telegraf DemonSet 


| 我已将 Telegraf 配置为获取有关 Kubernetes 集群的信息，但在 Cloud Insights 中看不到任何信息。我在与我配置的 Kubernetes 输入插件相关的 Telegraf 日志文件中看到 " 标题字段值无效 " 错误。 | 确保引用的 bearer_token 文件没有尾随换行符。要进行验证、请运行以下命令并确认其返回0：

 Tail -C1 <bearer_token_file> 
|===
可以从找到追加信息 link:concept_requesting_support.html["支持"] 页面。
